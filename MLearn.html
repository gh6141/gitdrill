
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>
$(function() {
  
  var ctx = new AudioContext();
  
  var bufferSize = 1024;
  var numberOfInputChannels = 1;
  var numberOfOutputChannels = 1;
  var node = ctx.createScriptProcessor(bufferSize, numberOfInputChannels, numberOfOutputChannels);
  
  var gainNode = ctx.createGain();
  gainNode.gain.value = document.getElementById('vol').value;
  
  var step = 0.0;
  var frequency = 0;
  
  node.onaudioprocess = function(e) {
    var data = e.outputBuffer.getChannelData(0);
    
    for(var i = 0; i < data.length; i++) {
      data[i] = Math.sin(2 * Math.PI * step);
      step += frequency / ctx.sampleRate;
    }
  }
  
  $("#play").click(function() {
    frequency = document.getElementById('freq').value;
    node.connect(gainNode);
    gainNode.connect(ctx.destination);
 
  });
  
  $("#stop").click(function() {
    node.disconnect();
  });
  
  $("#vol").change(function(e) {
    gainNode.gain.value = this.value;
  });
  
});
</script>
</head>
<body>
周波数: <input id="freq" type="number" style="width:50px" min="20" max="20000" value="440" step="1" required>Hz
<br>
音量: <input id="vol" type="range" min="0" max="1" step="0.01" value="0.5">
<br>
<button id="play">play</button>
<button id="stop">stop</button>
</body>
</html>